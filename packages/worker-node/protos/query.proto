syntax = "proto3";

package dest;

service Query {
  rpc PostQuery (EventRequest) returns (ResultResponse) {}
}

// Base

enum BaseType {
  DEFAULT_TYPE = 0;
  SQLITE = 2049;
  MARIADB = 3306;
  MYSQL8 = 3307;
}

message BaseRequest {
  BaseType type = 1;
  string name = 2;
}

message BaseResponse {
  bool success = 1;
}

// Result

message ResultItem {
  uint32 time = 1;
  string table = 2;
  repeated string rows = 3;
}

message ResultResponse {
  bool success = 1;
  ResultItem result = 2;
}

// Event

enum EventAction {
  DEFAULT_ACTION = 0;
  SAVE = 1;
  REMOVE = 2;
  READ = 3;
  WRITE = 4;
  ROOT = 5;
}

message EventItem {
  EventAction action = 1;
  string target = 2;
  repeated string values = 3;
}

message EventRequest {
  BaseType type = 1;
  string name = 2;
  EventItem event = 3;
}
